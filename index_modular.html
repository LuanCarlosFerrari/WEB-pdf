<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Processor - Sistema Modular</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#10b981',
                        accent: '#f59e0b',
                        purple: '#8b5cf6',
                        danger: '#ef4444',
                        dark: '#374151'
                    },
                    fontFamily: {
                        'mono': ['Consolas', 'Monaco', 'Courier New', 'monospace']
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- PDF Processing Libraries -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <!-- PDF.js for text extraction -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        // Configure PDF.js worker
        if (typeof pdfjsLib !== 'undefined') {
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
        }
    </script>

    <style>
        /* ===== VARIAVEIS CSS ===== */
        :root {
            --primary-color: #3b82f6;
            --primary-hover: #2563eb;
            --secondary-color: #10b981;
            --secondary-hover: #059669;
            --danger-color: #ef4444;
            --danger-hover: #dc2626;
            --warning-color: #f59e0b;
            --warning-hover: #d97706;
            --info-color: #3b82f6;
            --info-hover: #2563eb;
            --success-color: #10b981;
            --success-hover: #059669;
            --gray-light: #f8f9fa;
            --gray-medium: #6b7280;
            --gray-dark: #374151;
            --border-color: #d1d5db;
            --border-radius: 8px;
            --border-radius-sm: 6px;
            --border-radius-lg: 12px;
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --font-mono: 'Consolas', 'Monaco', 'Courier New', monospace;
        }

        /* ===== LAYOUT BASE ===== */
        .gradient-bg {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
        }

        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* ===== BOTÕES PADRONIZADOS ===== */
        .btn-base {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: var(--border-radius);
            border: none;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            min-height: 44px;
            min-width: 44px;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background-color: var(--primary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: white;
        }

        .btn-secondary:hover:not(:disabled) {
            background-color: var(--secondary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-danger:hover:not(:disabled) {
            background-color: var(--danger-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-warning {
            background-color: var(--warning-color);
            color: white;
        }

        .btn-warning:hover:not(:disabled) {
            background-color: var(--warning-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-gray {
            background-color: var(--gray-medium);
            color: white;
        }

        .btn-gray:hover:not(:disabled) {
            background-color: var(--gray-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
        }

        .btn-outline:hover:not(:disabled) {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
            min-height: 36px;
        }

        .btn-lg {
            padding: 1rem 2rem;
            font-size: 1.125rem;
            min-height: 52px;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .btn-icon-only {
            padding: 0.75rem;
            min-width: 44px;
            width: 44px;
            height: 44px;
        }

        /* ===== INPUTS PADRONIZADOS ===== */
        .input-base {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
            background-color: white;
        }

        .input-base:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .input-base:disabled {
            background-color: var(--gray-light);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .input-error {
            border-color: var(--danger-color);
        }

        .input-error:focus {
            border-color: var(--danger-color);
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
        }

        /* ===== WATERMARK INPUT FIX ===== */
        #watermark-text {
            position: relative;
            z-index: 1;
            pointer-events: auto;
            user-select: text;
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
        }

        #watermark-text:focus {
            outline: none !important;
            border-color: var(--primary-color) !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }

        /* ===== SELECT PADRONIZADO ===== */
        .select-base {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-size: 1rem;
            background-color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .select-base:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* ===== RANGE INPUTS ===== */
        .range-base {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--border-color);
            outline: none;
            transition: var(--transition);
        }

        .range-base::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            transition: var(--transition);
        }

        .range-base::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-md);
        }

        /* ===== CARDS E CONTAINERS ===== */
        .card-base {
            background: white;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
            padding: 1.5rem;
            transition: var(--transition);
        }

        .card-hover:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        /* ===== DROPZONE ===== */
        .file-drop-zone {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius-lg);
            transition: var(--transition);
            background-color: var(--gray-light);
        }

        .file-drop-zone:hover,
        .file-drop-zone.drag-over {
            border-color: var(--primary-color);
            background-color: rgba(59, 130, 246, 0.1);
        }

        /* ===== TABS ===== */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .tab-button {
            padding: 0.875rem 1.5rem;
            border: none;
            background-color: transparent;
            color: var(--gray-medium);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }

        .tab-button:hover {
            background-color: var(--gray-light);
            color: var(--gray-dark);
        }

        .tab-button.active {
            background-color: var(--primary-color);
            color: white;
            border-bottom-color: var(--primary-color);
        }

        /* ===== MODAIS ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: 2rem;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        /* ===== PROGRESS ===== */
        .progress-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 2rem;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            z-index: 1001;
            min-width: 400px;
        }

        .progress-container.show {
            display: block;
        }

        .progress-bar {
            height: 8px;
            background-color: var(--primary-color);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-track {
            width: 100%;
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }

        /* ===== TOASTS ===== */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            box-shadow: var(--shadow-lg);
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            background-color: var(--success-color);
        }

        .toast.error {
            background-color: var(--danger-color);
        }

        .toast.warning {
            background-color: var(--warning-color);
        }

        .toast.info {
            background-color: var(--info-color);
        }

        /* ===== LOGS ===== */
        .log-entry {
            padding: 0.75rem 1rem;
            margin: 0.25rem 0;
            border-radius: var(--border-radius-sm);
            font-family: var(--font-mono);
            font-size: 0.875rem;
            border-left: 4px solid;
        }

        .log-entry.info {
            background-color: #e0f2fe;
            color: #0277bd;
            border-left-color: #0277bd;
        }

        .log-entry.success {
            background-color: #e8f5e8;
            color: #2e7d32;
            border-left-color: #2e7d32;
        }

        .log-entry.warning {
            background-color: #fff3e0;
            color: #ef6c00;
            border-left-color: #ef6c00;
        }

        .log-entry.error {
            background-color: #ffebee;
            color: #c62828;
            border-left-color: #c62828;
        }

        /* ===== LISTA DE ARQUIVOS ===== */
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--gray-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .file-item:hover {
            box-shadow: var(--shadow-sm);
            transform: translateY(-1px);
        }

        .file-number {
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.875rem;
        }

        .file-name {
            flex: 1;
            margin: 0 1rem;
            font-weight: 600;
            color: var(--gray-dark);
        }

        .file-size,
        .file-status {
            font-size: 0.875rem;
            color: var(--gray-medium);
        }

        /* ===== REGRAS E PREVIEW ===== */
        .rule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin: 0.5rem 0;
            background: var(--gray-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
        }

        .rule-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .rule-find,
        .rule-replace {
            font-family: var(--font-mono);
            background: white;
            padding: 0.25rem 0.5rem;
            border-radius: var(--border-radius-sm);
            border: 1px solid var(--border-color);
            font-size: 0.875rem;
        }

        .rule-arrow {
            font-weight: bold;
            color: var(--gray-medium);
        }

        .preview-container {
            background: var(--gray-light);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .preview-page {
            position: relative;
            background: white;
            border: 1px solid var(--border-color);
            width: 200px;
            height: 260px;
            margin: 0 auto;
            overflow: hidden;
            border-radius: var(--border-radius-sm);
            box-shadow: var(--shadow-sm);
        }

        .watermark-sample {
            position: absolute;
            font-weight: bold;
            pointer-events: none;
            white-space: nowrap;
        }

        .preview-content {
            padding: 0.75rem;
            font-size: 0.75rem;
            color: var(--gray-medium);
        }

        /* ===== ESTADOS VAZIOS ===== */
        .no-files,
        .no-rules,
        .no-preview {
            text-align: center;
            color: var(--gray-medium);
            font-style: italic;
            padding: 2rem;
            background: var(--gray-light);
            border-radius: var(--border-radius);
            border: 2px dashed var(--border-color);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .tab-buttons {
                flex-wrap: wrap;
            }

            .tab-button {
                flex: 1;
                min-width: 120px;
                margin: 2px;
            }

            .progress-container {
                min-width: 300px;
                margin: 20px;
            }

            .toast {
                right: 10px;
                left: 10px;
                transform: translateY(-100px);
            }

            .toast.show {
                transform: translateY(0);
            }

            .btn-base {
                padding: 0.625rem 1.25rem;
                min-height: 40px;
            }

            .card-base {
                padding: 1rem;
            }
        }

        /* ===== ANIMAÇÕES ===== */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                transform: translateX(100%);
            }

            to {
                transform: translateX(0);
            }
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        .animate-slide-in {
            animation: slideInRight 0.3s ease-out;
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }
    </style>
</head>

<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <div class="gradient-bg text-white p-6 shadow-lg">
        <div class="container mx-auto">
            <h1 class="text-3xl font-bold mb-2">
                <i class="fas fa-file-pdf text-red-300 mr-3"></i>
                PDF Processor
            </h1>
            <p class="text-blue-100">Sistema modular para processamento de arquivos PDF</p>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container mx-auto p-6">
        <!-- File Upload Section -->
        <div class="card-base mb-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">
                <i class="fas fa-upload text-blue-500 mr-2"></i>
                Upload de Arquivos
            </h2>

            <div id="drop-zone"
                class="file-drop-zone border-2 border-dashed border-gray-300 rounded-lg p-8 text-center">
                <div class="mb-4">
                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                    <p class="text-lg text-gray-600 mb-2">Arraste e solte seus arquivos PDF aqui</p>
                    <p class="text-sm text-gray-500">ou clique para selecionar arquivos</p>
                </div>

                <!-- Multiple file inputs for different operations -->
                <input type="file" id="file-input" multiple accept=".pdf" class="hidden">

                <input type="file" id="files-merge" multiple accept=".pdf" class="hidden">

                <!-- Single file inputs for specific operations -->
                <input type="file" id="file-extract" accept=".pdf" class="hidden">
                <input type="file" id="file-watermark" accept=".pdf" class="hidden">
                <input type="file" id="file-rename" accept=".pdf" class="hidden">

                <button id="select-files-btn" class="btn-base btn-primary">
                    <i class="fas fa-folder-open mr-2"></i>
                    Selecionar Arquivos
                </button>
            </div>

            <div id="file-list" class="mt-4"></div>
        </div>

        <!-- Feature Tabs -->
        <div class="card-base overflow-hidden">
            <div class="tab-buttons flex flex-wrap bg-gray-50 border-b -m-6 mb-6 p-0">

                <button
                    class="tab-button flex-1 px-4 py-3 text-center font-medium text-gray-600 hover:bg-gray-100 active"
                    data-tab="split" onclick="switchTab('split')">
                    <i class="fas fa-cut mr-2"></i>
                    Dividir
                </button>
                <button class="tab-button flex-1 px-4 py-3 text-center font-medium text-gray-600 hover:bg-gray-100"
                    data-tab="merge" onclick="switchTab('merge')">
                    <i class="fas fa-layer-group mr-2"></i>
                    Mesclar
                </button>
                <button class="tab-button flex-1 px-4 py-3 text-center font-medium text-gray-600 hover:bg-gray-100"
                    data-tab="extract" onclick="switchTab('extract')">
                    <i class="fas fa-scissors mr-2"></i>
                    Extrair
                </button>
                <button class="tab-button flex-1 px-4 py-3 text-center font-medium text-gray-600 hover:bg-gray-100"
                    data-tab="watermark" onclick="switchTab('watermark')">
                    <i class="fas fa-stamp mr-2"></i>
                    Marca d'água
                </button>
                <button class="tab-button flex-1 px-4 py-3 text-center font-medium text-gray-600 hover:bg-gray-100"
                    data-tab="rename" onclick="switchTab('rename')">
                    <i class="fas fa-edit mr-2"></i>
                    Renomear
                </button>
            </div>


            <!-- Split Tab -->
            <div id="split-tab" class="tab-content active p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-700">Dividir PDFs</h3>

                <!-- File Info for Split -->
                <div id="split-file-info" class="hidden mb-6 p-4 border border-gray-300 rounded-lg bg-gray-50">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-file-pdf text-red-500 text-2xl mr-3"></i>
                            <div>
                                <h5 class="font-medium text-gray-800" id="split-file-name">arquivo.pdf</h5>
                                <p class="text-sm text-gray-600">
                                    <span id="split-file-size">0 KB</span> •
                                    <span id="split-file-pages">0 páginas</span>
                                </p>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="inline-block px-2 py-1 bg-green-100 text-green-800 rounded text-sm">
                                Pronto para dividir
                            </span>
                        </div>
                    </div>
                </div>

                <div class="mb-6">
                    <h4 class="font-medium mb-3">Modo de Divisão</h4>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="split-mode" value="pages" checked class="mr-2">
                            <span>Dividir em páginas individuais</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="split-mode" value="half" class="mr-2">
                            <span>Dividir pela metade</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="split-mode" value="custom" class="mr-2">
                            <span>Intervalos customizados</span>
                        </label>
                    </div>

                    <div id="custom-split-options" class="mt-4" style="display: none;">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Intervalos de páginas:</label>
                        <input type="text" id="split-ranges" class="input-base" placeholder="Ex: 1-5, 7, 10-15">
                        <p class="text-xs text-gray-500 mt-1">Use vírgulas para separar intervalos. Ex: 1-5, 7, 10-15
                        </p>
                    </div>
                </div>

                <div class="flex gap-3">
                    <button id="split-pdfs" class="btn-base btn-secondary btn-lg">
                        <i class="fas fa-cut mr-2"></i>Dividir PDFs
                    </button>
                </div>
            </div>

            <!-- Merge Tab -->
            <div id="merge-tab" class="tab-content p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-700">Mesclar PDFs</h3>

                <div class="mb-6">
                    <h4 class="font-medium mb-3">Ordem de Mesclagem</h4>
                    <select id="merge-order" class="select-base">
                        <option value="original">Ordem original</option>
                        <option value="alphabetical">Ordem alfabética</option>
                        <option value="size-asc">Tamanho (menor para maior)</option>
                        <option value="size-desc">Tamanho (maior para menor)</option>
                        <option value="date-asc">Data (mais antigo primeiro)</option>
                        <option value="date-desc">Data (mais recente primeiro)</option>
                    </select>
                </div>

                <div id="merge-preview" class="mb-6 border border-gray-300 rounded-md p-4 bg-gray-50">
                    <p class="no-files">Nenhum PDF carregado para mesclagem</p>
                </div>

                <!-- File List for Merge -->
                <div id="merge-file-list" class="mt-4 mb-4"></div>

                <button id="merge-pdfs" class="btn-base btn-secondary btn-lg">
                    <i class="fas fa-layer-group mr-2"></i>Mesclar PDFs
                </button>
            </div>

            <!-- Extract Tab -->
            <div id="extract-tab" class="tab-content p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-700">Extrair Páginas</h3>

                <div class="mb-6">
                    <h4 class="font-medium mb-3">Modo de Extração</h4>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="extract-mode" value="first" checked class="mr-2">
                            <span>Primeira página</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="extract-mode" value="last" class="mr-2">
                            <span>Última página</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="extract-mode" value="odd" class="mr-2">
                            <span>Páginas ímpares</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="extract-mode" value="even" class="mr-2">
                            <span>Páginas pares</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="extract-mode" value="custom" class="mr-2">
                            <span>Páginas específicas</span>
                        </label>
                    </div>

                    <div id="custom-extract-options" class="mt-4" style="display: none;">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Páginas a extrair:</label>
                        <input type="text" id="extract-ranges" class="input-base" placeholder="Ex: 1-5, 7, 10-15">
                        <p class="text-xs text-gray-500 mt-1">Use vírgulas para separar páginas/intervalos</p>
                    </div>
                </div>

                <div id="extract-preview" class="mb-6 border border-gray-300 rounded-md p-4 bg-gray-50">
                    <p class="no-files">Nenhum PDF carregado para extração</p>
                </div>

                <!-- File Info for Extract -->
                <div id="extract-file-info" class="hidden mb-4"></div>

                <!-- Pages Input -->
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Páginas:</label>
                    <input type="text" id="pages-input" placeholder="Ex: 1,3-5,7" disabled
                        class="input-base disabled:bg-gray-100">
                </div>

                <button id="extract-pages" class="btn-base btn-warning btn-lg">
                    <i class="fas fa-scissors mr-2"></i>Extrair Páginas
                </button>
            </div>

            <!-- Watermark Tab -->
            <div id="watermark-tab" class="tab-content p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-700">Adicionar Marca d'água</h3>

                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-medium mb-3">Configurações da Marca d'água</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1"
                                    for="watermark-text">Texto:</label>
                                <input type="text" id="watermark-text" name="watermark-text" class="input-base"
                                    placeholder="Texto da marca d'água" autocomplete="off" spellcheck="false">
                            </div>

                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Tamanho:</label>
                                    <input type="range" id="watermark-size" min="20" max="100" value="48"
                                        class="range-base">
                                    <span class="text-xs text-gray-500">48px</span>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Opacidade:</label>
                                    <input type="range" id="watermark-opacity" min="0.1" max="1" step="0.1" value="0.3"
                                        class="range-base">
                                    <span class="text-xs text-gray-500">30%</span>
                                </div>
                            </div>

                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Rotação:</label>
                                    <input type="range" id="watermark-rotation" min="0" max="360" value="45"
                                        class="range-base">
                                    <span class="text-xs text-gray-500">45°</span>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Cor:</label>
                                    <input type="color" id="watermark-color" value="#cccccc"
                                        class="w-full h-10 rounded border border-gray-300">
                                </div>
                            </div>

                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                <div class="flex items-center text-blue-700">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <span class="text-sm font-medium">Aplicação Automática</span>
                                </div>
                                <p class="text-blue-600 text-xs mt-1">
                                    A marca d'água será repetida automaticamente em várias posições em cada página para
                                    melhor cobertura e proteção.
                                </p>
                            </div>

                            <div class="flex gap-2">
                                <button id="preview-watermark" class="btn-base btn-outline btn-sm">
                                    <i class="fas fa-eye mr-2"></i>Preview
                                </button>
                                <button id="reset-watermark-settings" class="btn-base btn-danger btn-sm">
                                    <i class="fas fa-undo mr-2"></i>Reset
                                </button>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 class="font-medium mb-3">Visualização</h4>
                        <div id="watermark-preview"
                            class="border border-gray-300 rounded-lg p-4 bg-gray-50 min-h-[411px] max-h-[411px] overflow-y-auto">
                            <div class="text-center text-gray-500">
                                <i class="fas fa-stamp text-3xl mb-2"></i>
                                <p>Digite um texto para ver a prévia</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-6">
                    <button id="add-watermark" class="btn-base btn-secondary btn-lg">
                        <i class="fas fa-stamp mr-2"></i>Adicionar Marca d'água
                    </button>
                </div>

                <!-- File Info for Watermark -->
                <div id="watermark-file-info" class="hidden mt-4"></div>
            </div>

            <!-- Rename Tab -->
            <div id="rename-tab" class="tab-content p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-700">Renomear e Dividir por Páginas</h3>

                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-medium mb-3">Configurações de Renomeação</h4>
                        <div class="space-y-4">
                            <!-- Layout Selector -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Layout do Documento:</label>
                                <select id="rename-layout" class="select-base">
                                    <option value="itau">Extratos Itaú - PIX, Boleto e TED</option>
                                    <option value="bradesco">Extratos Bradesco - Transferência e Boleto</option>
                                    <option value="custom" disabled>Personalizado (em breve)</option>
                                </select>
                                <p class="text-xs text-gray-500 mt-1">Suporta comprovantes de diferentes bancos</p>
                            </div>

                            <!-- Itaú Specific Options -->
                            <div id="itau-options">
                                <div
                                    class="bg-blue-50 border border-blue-200 rounded-lg p-4 max-h-[300px] overflow-y-auto">
                                    <h5 class="font-medium text-blue-800 mb-2">
                                        <i class="fas fa-university mr-2"></i>
                                        Configurações Itaú
                                    </h5>
                                    <p class="text-blue-700 text-sm mb-3">
                                        Detecta automaticamente e extrai dados de comprovantes PIX, Boletos e TEDs do
                                        Itaú.
                                    </p>

                                    <div class="space-y-3">
                                        <div>
                                            <label class="block text-sm font-medium text-blue-700 mb-1">Tipos
                                                Suportados:</label>
                                            <div class="space-y-1">
                                                <div class="flex items-center text-sm">
                                                    <i class="fas fa-mobile-alt text-blue-600 mr-2"></i>
                                                    <span
                                                        class="bg-blue-100 text-blue-800 px-2 py-1 rounded mr-2">PIX</span>
                                                    <span class="text-gray-600">Comprovantes de transferência PIX</span>
                                                </div>
                                                <div class="flex items-center text-sm">
                                                    <i class="fas fa-barcode text-orange-600 mr-2"></i>
                                                    <span
                                                        class="bg-orange-100 text-orange-800 px-2 py-1 rounded mr-2">Boleto</span>
                                                    <span class="text-gray-600">Comprovantes de pagamento de
                                                        boleto</span>
                                                </div>
                                                <div class="flex items-center text-sm">
                                                    <i class="fas fa-university text-purple-600 mr-2"></i>
                                                    <span
                                                        class="bg-purple-100 text-purple-800 px-2 py-1 rounded mr-2">TED</span>
                                                    <span class="text-gray-600">Comprovantes de TED</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium text-blue-700 mb-1">Padrão de
                                                Nome:</label>
                                            <div class="bg-white p-2 rounded border border-blue-200 font-mono text-sm">
                                                <span class="text-green-600">[Nome do Destinatário]</span> +
                                                <span class="text-blue-600"> valor R$ </span> +
                                                <span class="text-purple-600">[Valor]</span>
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium text-blue-700 mb-1">Exemplo:</label>
                                            <div class="bg-gray-100 p-2 rounded text-sm">
                                                GOODYEAR DO BRASIL valor R$ 27.296,82.pdf
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Bradesco Specific Options -->
                            <div id="bradesco-options" style="display: none;">
                                <div
                                    class="bg-red-50 border border-red-200 rounded-lg p-4 max-h-[300px] overflow-y-auto">
                                    <h5 class="font-medium text-red-800 mb-2">
                                        <i class="fas fa-university mr-2"></i>
                                        Configurações Bradesco
                                    </h5>
                                    <p class="text-red-700 text-sm mb-3">
                                        Detecta automaticamente e extrai dados de comprovantes de Transferência e
                                        Boletos do
                                        Bradesco.
                                    </p>

                                    <div class="space-y-3">
                                        <div>
                                            <label class="block text-sm font-medium text-red-700 mb-1">Tipos
                                                Suportados:</label>
                                            <div class="space-y-1">
                                                <div class="flex items-center text-sm">
                                                    <i class="fas fa-exchange-alt text-red-600 mr-2"></i>
                                                    <span
                                                        class="bg-red-100 text-red-800 px-2 py-1 rounded mr-2">Transferência</span>
                                                    <span class="text-gray-600">Comprovantes de transferência</span>
                                                </div>
                                                <div class="flex items-center text-sm">
                                                    <i class="fas fa-barcode text-orange-600 mr-2"></i>
                                                    <span
                                                        class="bg-orange-100 text-orange-800 px-2 py-1 rounded mr-2">Boleto</span>
                                                    <span class="text-gray-600">Comprovantes de pagamento de
                                                        boleto</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium text-red-700 mb-1">Padrão de
                                                Nome:</label>
                                            <div class="bg-white p-2 rounded border border-red-200 font-mono text-sm">
                                                <span class="text-green-600">[Razão Social/Beneficiário]</span> +
                                                <span class="text-blue-600"> valor R$ </span> +
                                                <span class="text-purple-600">[Valor Total]</span>
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium text-red-700 mb-1">Exemplo:</label>
                                            <div class="bg-gray-100 p-2 rounded text-sm">
                                                TAURUS DIST DE PETROLEO LTDA valor R$ 130.600,00.pdf
                                            </div>
                                        </div>

                                        <div>
                                            <label class="block text-sm font-medium text-red-700 mb-1">Campos
                                                Extraídos:</label>
                                            <div class="space-y-1 text-xs">
                                                <div class="flex items-center">
                                                    <span class="w-2 h-2 bg-red-400 rounded-full mr-2"></span>
                                                    <span class="text-gray-600"><strong>Razão Social:</strong> Nome da
                                                        empresa/pessoa beneficiária</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="w-2 h-2 bg-red-400 rounded-full mr-2"></span>
                                                    <span class="text-gray-600"><strong>Beneficiário:</strong> Nome do
                                                        destinatário da transferência</span>
                                                </div>
                                                <div class="flex items-center">
                                                    <span class="w-2 h-2 bg-red-400 rounded-full mr-2"></span>
                                                    <span class="text-gray-600"><strong>Valor Total:</strong> Valor da
                                                        transação</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Custom Options (Future) -->
                            <div id="custom-options" style="display: none;">
                                <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                                    <h5 class="font-medium text-gray-700 mb-2">
                                        <i class="fas fa-cog mr-2"></i>
                                        Configurações Personalizadas
                                    </h5>
                                    <p class="text-gray-600 text-sm">
                                        Em desenvolvimento - permitirá criar padrões customizados de extração.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h4 class="font-medium mb-3">Preview da Renomeação</h4>
                        <div id="rename-preview"
                            class="border border-gray-300 rounded-lg p-4 bg-gray-50 min-h-[411px] max-h-[411px] overflow-y-auto">
                            <div class="text-center text-gray-500">
                                <i class="fas fa-file-pdf text-3xl mb-2"></i>
                                <p>Carregue um PDF para ver o preview da renomeação</p>
                            </div>
                        </div>

                        <!-- Progress for rename -->
                        <div id="rename-progress" class="mt-4 hidden">
                            <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
                                <span>Processando páginas...</span>
                                <span id="rename-progress-text">0%</span>
                            </div>
                            <div class="progress-track">
                                <div id="rename-progress-bar" class="progress-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- File Info -->
                <div id="rename-file-info" class="hidden mb-6 p-4 border border-gray-300 rounded-lg bg-gray-50">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <i class="fas fa-file-pdf text-red-500 text-2xl mr-3"></i>
                            <div>
                                <h5 class="font-medium text-gray-800" id="rename-file-name">arquivo.pdf</h5>
                                <p class="text-sm text-gray-600">
                                    <span id="rename-file-size">0 KB</span> •
                                    <span id="rename-file-pages">0 páginas</span>
                                </p>
                            </div>
                        </div>
                        <div class="text-right">
                            <span class="inline-block px-2 py-1 bg-green-100 text-green-800 rounded text-sm">
                                Pronto para processar
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex gap-3 mt-6">
                    <button id="rename-process" class="btn-base btn-secondary btn-lg">
                        <i class="fas fa-edit mr-2"></i>
                        Processar e Renomear
                    </button>
                    <button id="rename-preview-btn" class="btn-base btn-outline">
                        <i class="fas fa-eye mr-2"></i>
                        Analisar Arquivo
                    </button>
                    <button id="rename-download-all" class="btn-base btn-primary hidden">
                        <i class="fas fa-download mr-2"></i>
                        Baixar Todos
                    </button>
                </div>

                <!-- Results Section -->
                <div id="rename-results" class="hidden mt-6">
                    <h4 class="font-medium mb-3 text-gray-700">Páginas Processadas</h4>
                    <div id="rename-results-list" class="space-y-2 max-h-60 overflow-y-auto">
                        <!-- Results will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Progress Modal -->
    <div id="progress-container" class="progress-container">
        <div class="text-center">
            <div class="mb-4">
                <i class="fas fa-cog fa-spin text-3xl text-blue-500"></i>
            </div>
            <h3 class="text-lg font-semibold mb-2">Processando...</h3>
            <p id="progress-text" class="text-gray-600 mb-4">Iniciando processamento...</p>
            <div class="progress-track">
                <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
            </div>
            <p id="progress-percentage" class="text-sm text-gray-500 mt-2">0%</p>
        </div>
    </div>

    <!-- Modular Scripts -->
    <script src="js/ui.js"></script>
    <script src="js/config.js"></script>
    <script src="js/core.js"></script>

    <!-- Template System -->
    <script src="js/templates/template-manager.js"></script>
    <script src="js/templates/itau-template.js"></script>
    <script src="js/templates/bradesco-template.js"></script>

    <script src="js/split.js"></script>
    <script src="js/merge.js"></script>
    <script src="js/extract.js"></script>
    <script src="js/watermark.js"></script>
    <script src="js/rename.js"></script>
    <script src="js/init.js"></script>

    <script>
        // Initialize system when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Show startup message
            setTimeout(() => {
                UI.showToast('Sistema modular iniciado! 🚀', 'success');
                UI.addLog('Sistema modular carregado com sucesso');
            }, 1000);

            // Update range input displays
            const updateRangeDisplay = (inputId, suffix = '') => {
                const input = document.getElementById(inputId);
                const display = document.querySelector(`#${inputId} + span`);
                if (input && display) {
                    input.addEventListener('input', (e) => {
                        display.textContent = e.target.value + suffix;
                    });
                }
            };

            updateRangeDisplay('watermark-size', 'px');
            updateRangeDisplay('watermark-opacity', '%');
            updateRangeDisplay('watermark-rotation', '°');

            // Fix específico para o campo de texto da marca d'água
            const watermarkTextInput = document.getElementById('watermark-text');
            if (watermarkTextInput) {
                // Garantir que o campo está habilitado e funcional
                watermarkTextInput.disabled = false;
                watermarkTextInput.readOnly = false;
                watermarkTextInput.setAttribute('contenteditable', 'true');

                // Forçar foco se necessário
                watermarkTextInput.addEventListener('click', function () {
                    this.focus();
                });

                // Debug para verificar se está funcionando
                watermarkTextInput.addEventListener('input', function () {
                    console.log('Texto digitado na marca d\'água:', this.value);
                });

                console.log('Campo de texto da marca d\'água configurado:', watermarkTextInput);

                // Re-habilitar o campo após qualquer mudança de aba
                const observer = new MutationObserver(function (mutations) {
                    mutations.forEach(function (mutation) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'disabled') {
                            if (watermarkTextInput.disabled) {
                                console.log('Campo de marca d\'água foi desabilitado, re-habilitando...');
                                setTimeout(() => {
                                    watermarkTextInput.disabled = false;
                                }, 10);
                            }
                        }
                    });
                });

                observer.observe(watermarkTextInput, { attributes: true });
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'l') {
                e.preventDefault();
                UI.clearLogs();
            }
        });
    </script>
</body>

</html>